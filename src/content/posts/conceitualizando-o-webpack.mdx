---
templateKey: blog-post
title: "Conceitualizando o webpack"
date: 2017-02-14T20:02:45.080Z
slug: conceitualizando-o-webpack
description: "Abordagem conceitual do webpack, que apesar de ser uma ferramenta cada vez mais presente em nosso dia a dia, ainda √© muito mistificada, e por isso, pouco compreendida."
category: tech
lang: pt
keywords:
  - keyword
external: false
---

Fala galera! Voltei :D E dessa vez para escrever sobre uma ferramenta que est√° cada vez mais presente em nosso dia a dia, mas que ainda √© muito mistificada, e por isso, n√£o muito compreendida.

Portanto, o foco aqui ser√° explicar da forma mais objetiva poss√≠vel, o que afinal esse webpack tem de bom.

## Disclaimer

**Este post n√£o √© outra demo _React + webpack_ ou _Vue + webpack_**.

Minha ideia aqui √© compilar conte√∫do gen√©rico para quem quer realmente entender os conceitos e possibilidades atreladas ao webpack.

Sendo assim‚Ä¶ Bora pro post!

## Dive into the webpack

Visto que entender o que √© e tamb√©m qual √© o papel do webpack no desenvolvimento de um projeto ainda gera muita confus√£o, vou come√ßar este post definindo que o webpack nada mais √© que parte de um conceito de ferramentas conhecido como **Build Tools**, que em resumo, **√© um conjunto de ferramentas que automatizam determinados processos na entrega de um software**.

E sendo esse conceito bastante amplo, o importante para voc√™ saber, √© que no contexto de Build Tools, o webpack √© sumariamente definido como um **Bundler**.

Sendo assim, **o principal objetivo do webpack √© agrupar os recursos utilizados em um projeto e transform√°-los em um √∫nico arquivo**.

Uma outra coisa interessante de complementar, √© que no contexto de Build Tools, **o webpack √© bem diferente de ferramentas como Make, Grunt, Gulp, Brocolli entre outros Task Runners**, apesar de que em algumas ocasi√µes, √© poss√≠vel substituir completamente um Task Runner por um Bundler.

Mas para que voc√™ possa entender bem todo o poder e hype do webpack, voc√™ vai precisar compreender seus _core concepts_, e √© isso que vamos fazer agora.

## Core Concepts

Bom, antes de come√ßarmos a definir os conceitos debaixo do cap√¥ do webpack, veja abaixo um exemplo m√≠nimo de configura√ß√£o que o webpack demanda para funcionar.

```javascript
// webpack.config.js

module.exports = {
  entry: {
    ...
  },
  output: {
    ...
  },
  module: {
    rules: [
      ...
    ]
  },
  plugins: [
    ...
  ]
};
```

N√£o deixe de observar bem o exemplo, pois √© a partir dele que irei destrinchar os conceitos do webpack.

### Entry

_Entry_ √© o conceito mais b√°sico do webpack, pois √© a partir dele que o sistema de **bundling** do webpack ser√° iniciado, permitindo com que o webpack seja capaz de gerar [um grafo de depend√™ncias](https://webpack.js.org/concepts/dependency-graph/) do projeto.

E s√≥ para simplificar a compreens√£o desse conceito, pense que **o arquivo declarado na propriedade `entry` ser√° o arquivo main da aplica√ß√£o**, e de alguma forma, todas as depend√™ncias do projeto dever√£o estar conectadas a ele.

Mas para ilustrar, veja no exemplo abaixo como declarar esta propriedade:

```javascript
module.exports = {
 entry: './path/to/my/entry/file.js',
 ...
};
```

Viu? N√£o √© nada de mais, mas **isso n√£o acaba aqui**, pois al√©m desta declara√ß√£o, **existem outros meios de configurar a propriedade `entry`**, mas para n√£o sair muito do foco do post, acesse [este link](https://webpack.js.org/concepts/entry-points/) e descubra outras formas de se fazer isso.

### Output

Uma vez declarado o arquivo raiz na propriedade `entry`, permitindo assim que o webpack saiba sobre todas as depend√™ncias que ele deve empacotar, o pr√≥ximo passo √© inform√°-lo **como e onde ser√° a sa√≠da do arquivo gerado ao final do processo de bundling**, e pra isso, vamos utilizar a propriedade `output`.

Veja abaixo um dos caminhos de configura√ß√£o da propriedade `output`:

```javascript
module.exports = {
  ...
  output: {
    path: path.resolve(__dirname, 'dist'),
    filename: 'my-first-webpack.bundle.js'
  },
  ...
};
```

E como no caso da propriedade `entry`, **a propriedade `output` tamb√©m √© extremamente flex√≠vel e proporciona diversas outras abordagens de configura√ß√£o**, e para saber como fazer isso, acesse [este link](https://webpack.js.org/concepts/output/).

### Module e Loaders

Ap√≥s declarar a entrada e a sa√≠da do seu **bundle app** (arquivo gerado ao final do processo de bundle e que ser√° utilizado em produ√ß√£o), agora √© hora de definir como o webpack ir√° interpretar seus assets e quais assets voc√™ deseja empacotar.

Para isso, primeiramente o webpack deve saber quais s√£o os tipos de assets que voc√™ possui no projeto (_.jsx, .html, .scss, .css, .jpg_, etc.), para que assim os loaders transformem estes assets em m√≥dulos leg√≠veis para o webpack, fazendo que o mesmo consiga ent√£o adicion√°-los ao grafo de depend√™ncias do sistema de bundling.

Al√©m disso, √© importante dizer que **os loaders n√£o ir√£o atuar no c√≥digo fonte do seu projeto**. Eles apenas ir√£o ler o conte√∫do deles, _transformar_ este conte√∫do e retorn√°-lo em uma nova sa√≠da para o webpack, sem nenhuma altera√ß√£o no original.

E para dar continuidade a este conceito, veja o c√≥digo abaixo:

```javascript
module.exports = {
  ...
  module: {
    rules: [
      {test: /\.(js|jsx)$/, use: 'babel-loader'}
    ]
  },
  ...
}
```

Note no c√≥digo que temos uma declara√ß√£o `module`, e ela basicamente define o local onde voc√™ ir√° definir os loaders e respectivas regras de utiliza√ß√£o deles.

E explicando de forma bem objetiva o que √© adicionado na propriedade `module`:

**rules**

Escopo das configura√ß√µes dos loaders e parsers utilizados.

**test**

Aspecto que define os arquivos que devem ser interpretados, transformados e enviados para o grafo de depend√™ncia do webpack por um determinado loader.

**use**

Aspecto que define um ou mais loaders que ser√£o utilizados para transformar o conte√∫do do asset em um m√≥dulo e adicion√°-lo ao grafo de depend√™ncia (que eventualmente ser√° o seu bundle app).

E √© isso, como no caso da propriedade `entry` e `output`, o conceito de loaders √© extremamente poderoso e possui diversas formas de configura√ß√£o. Veja [este link](https://webpack.js.org/concepts/loaders/) e saiba mais.

### Plugins

E por √∫ltimo, o mais importante dos core concepts do webpack, _Plugins_. Prepare-se para fritar o c√©rebro‚Ä¶ü§£

E acredite em mim, n√£o estou sendo clich√™ quando digo isso, a pegadinha nesse conceito, √© que o webpack em si, √© apenas uma resultante do seu pr√≥prio sistema de plugins, ou seja, o webpack √© uma variedade de plugins built-in para bundling que utilizam-se de um mesmo sistema de plugins conhecido como [tapable](https://github.com/webpack/tapable).

Meio loucura isso, n√©? Certamente. Por√©m, √© totalmente incr√≠vel tamb√©m, pois nos d√° flexibilidade inigual√°vel com rela√ß√£o a outras ferramentas semelhantes, sendo este conceito um dos grandes motivos da ascens√£o do webpack atualmente.

E s√≥ para fechar este conceito, segue abaixo um exemplo simples de como configurar plugins (da comunidade ou do pr√≥prio webpack) no seu arquivo de configura√ß√£o.

```javascript
module.exports = {
  ...
  plugins: [
    new webpack.optimize.UglifyJsPlugin(),
    new HtmlWebpackPlugin({template: './src/index.html'})
  ]
}
```

E como fiz nos outros conceitos, d√™ uma olhada [neste link](https://webpack.js.org/concepts/plugins/) para entender mais sobre como configurar e tamb√©m como criar plugins para o webpack.

## Mas e ai gostando? Espero que sim, pois o webpack n√£o para por aqui...

Mesmo o webpack sendo uma ferramenta que tem como prop√≥sito principal empacotar recursos de um projeto, ele n√£o para por a√≠, e para esclarecer isso, separei alguns outros recursos oferecidos por ele.

### Hot Module Replacement

O **Hot Module Replacement** ou **HMR**, talvez seja a √≠sca de todo entusiasta webpack, pois mesmo sendo uma feature opcional, sua utiliza√ß√£o √© praticamente obrigat√≥ria para qualquer desenvolvedor‚Ä¶ Mas afinal, o que √© esse tal de HMR?

HMR √© semelhante a uma t√©cnica conhecida por n√≥s como **live reload**.

**A diferen√ßa √© que o HMR** n√£o recarrega toda a aplica√ß√£o ap√≥s cada altera√ß√£o no c√≥digo fonte, o HMR **ir√° recarregar apenas a parte afetada pela altera√ß√£o**.

E isso, √© extremamente √∫til em alguns casos, como por exemplo se voc√™ estiver utilizando alguma ferramenta para controle do estado da aplica√ß√£o, com o uso do HMR, voc√™ poder√° manter o estado da aplica√ß√£o, mesmo ap√≥s altera√ß√µes no c√≥digo fonte, sem refresh da p√°gina e reinicializa√ß√£o do _application state_.

### Code Splitting

Como no caso do HMR, **Code Splitting** tamb√©m √© uma outra feature que √© opcional, por√©m seu uso √© praticamente obrigat√≥rio.

No caso do Code Splitting, o webpack **oferece a possibilidade de ‚Äúdividir‚Äù o c√≥digo** gerado ao final do processo de bundling em v√°rios arquivos, possibilitando assim que voc√™ carregue os recursos sob demanda, visando melhorar a performance, e consequentemente, a experi√™ncia do usu√°rio ao utilizar a sua aplica√ß√£o.

### Asset Hashing

Mesmo que as vezes a palavra _hash_ cause receio e medo, uma vez que envolve criptografia, e isso arremete a complexidade de implementa√ß√£o, no caso do webpack a funcionalidade de **Asset Hashing** possui uma aplica√ß√£o simples e objetiva.

Utilizar a **Asset Hashing permite que atrav√©s de algumas declara√ß√µes** no arquivo de configura√ß√£o do webpack, **voc√™ aplique no nome do arquivo gerado ao fim do processo de bundling uma hash**, ou seja, √© possivel utilizar `app.d82kas4so.js` ao inv√©s de `app.js` em produ√ß√£o.

Sendo assim, toda vez que o processo de bundling finalizar, o bundle app ser√° gerado com uma hash diferente, o que em produ√ß√£o, for√ßar√° o _Client_ a limpar o cache sempre.

### Extensibilidade (Plugins/Loaders)

Sendo parte conceitual do webpack, **a extensibilidade proposta por ele √© um dos artif√≠cios mais encorajadores ao se escolher entre o webpack e outros bundlers**, pois se em algum momento voc√™ n√£o encontrar um plugin ou um loader que faz o trabalho pesado do seu processo de bundling, voc√™ pode simplesmente fazer o seu pr√≥prio plugin e/ou loader.

### Configuration Driven

O pensamento de que o webpack √© um cara dif√≠cil de se trabalhar, em geral deve-se ao fato de que a forma que ele demanda instru√ß√µes √© baseada em configura√ß√µes.

Voc√™ n√£o deve pensar em paradigmas de programa√ß√£o e se determinado processo √© ass√≠ncrono ou n√£o.

A abordagem do webpack na verdade oferece mais simplicidade para o que ele se prop√µe a fazer do que complexidade, e por isso, **entender os conceitos do webpack √© primordial para um bom uso da ferramenta**.

### Interoper√°vel

A interoperabilidade do webpack com bibliotecas e frameworks como Polymer, Angular, React, Vue entre outras √© espetacular, como tamb√©m com os diversos padr√µes que todo dia tem entrado no JavaScript, mas que obviamente, voc√™ quer utilizar desde j√°.

Al√©m disso, tamb√©m vale lembrar que quando o assunto s√£o as famosas pseudo-linguagens como: SCSS, TypeScript, Flow entre outras, ferramentas como webpack s√£o bastante √∫teis.

### Performance

E para fechar o post, mesmo n√£o parecendo um recurso, pois est√° impl√≠cito no webpack desde o primeiro uso, **o time de desenvolvimento do webpack n√£o trata a performance dele como um resultado, mas sim como uma feature**, pois al√©m do que ele entrega naturalmente, ele ainda assim √© permissivo caso voc√™ queira elevar o n√≠vel de efici√™ncia e efic√°cia do sistema bundling.

## The End

Mas √© isso pessoal! Espero mesmo que tenham gostado e que eu tenha esclarecido bem os principais conceitos, benef√≠cios e funcionalidades do webpack.

E se voc√™ curtiu e/ou tem mais algo para contribuir com o tema abordado, deixe seu coment√°rio, pois √© sempre bom receber feedbacks para melhorar os futuros posts.

### Refer√™ncias:

- [webpack.js.org](https://webpack.js.org/)
- [Webpack by survivejs](https://survivejs.com/webpack/)
- [Advanced Webpack by survivejs](https://presentations.survivejs.com/advanced-webpack/#/?_k=1y6aom)
- [@github/rstacruz/webpack-tricks](https://github.com/rstacruz/webpack-tricks)
- [Migrating to Webpack 2: some tips and gotchas](https://swizec.com/blog/using-webpack-2-production/swizec/7356)
- [Migrating to Webpack 2](http://javascriptplayground.com/blog/2016/10/moving-to-webpack-2/)
- [The Fine Art of the Webpack 2 Config](https://blog.flennik.com/the-fine-art-of-the-webpack-2-config-dc4d19d7f172?gi=5622712edbd2)
- [Webpack Concepts](https://webpack.js.org/concepts/#components/sidebar/sidebar.jsx)
- [Hot Module Replacement](https://webpack.js.org/concepts/hot-module-replacement/)

‚ñ≤
